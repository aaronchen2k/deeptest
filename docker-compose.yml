version : '2'
services:
  ngtesting-postgres:
    image: registry.cn-hangzhou.aliyuncs.com/ngtesting/ngtesting-postgres
    environment:
      - POSTGRES_PASSWORD=P2ssw0rd
    ports:
      - "55432:5432"
    expose:
      - "5432"

  ngtesting-web:
    image: registry.cn-hangzhou.aliyuncs.com/ngtesting/ngtesting-web
    depends_on:
      - ngtesting-postgres
    ports:
      - "58080:8080"
    command: ["/wait-for-it.sh", "ngtesting-postgres:5432", "--", "/setup.sh", "--", "/usr/bin/java", "-Djava.security.egd=file:/dev/./urandom", "-jar", "/ngtesting-web.jar", "--spring.profiles.active=docker"]